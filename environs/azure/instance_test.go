// Copyright 2013 Canonical Ltd.
// Licensed under the AGPLv3, see LICENCE file for details.

package azure

import (
	. "launchpad.net/gocheck"
	"launchpad.net/gwacl"
	"launchpad.net/juju-core/instance"
)

type InstanceSuite struct{}

var _ = Suite(new(InstanceSuite))

var deploymentName = "deploymentName"

// Deployments' hostnames are randomly generated by Azure.
var deploymentFQDN = "53b117c3126a4f1b8b23bc36c2c94dd1.cloudapp.net"

func (StorageSuite) TestId(c *C) {
	testDeployment := gwacl.Deployment{Name: deploymentName, URL: "http://" + deploymentFQDN}
	azInstance := azureInstance{testDeployment}
	c.Check(azInstance.Id(), Equals, instance.Id(deploymentName))
}

func (StorageSuite) TestDNSName(c *C) {
	testDeployment := gwacl.Deployment{Name: deploymentName, URL: "http://" + deploymentFQDN}
	azInstance := azureInstance{testDeployment}
	dnsName, err := azInstance.DNSName()
	c.Assert(err, IsNil)
	c.Check(dnsName, Equals, deploymentFQDN)
}

func (StorageSuite) TestWaitDNSName(c *C) {
	testDeployment := gwacl.Deployment{Name: deploymentName, URL: "http://" + deploymentFQDN}
	azInstance := azureInstance{testDeployment}
	dnsName, err := azInstance.WaitDNSName()
	c.Assert(err, IsNil)
	c.Check(dnsName, Equals, deploymentFQDN)
}
