#!/usr/bin/env python
__metaclass__ = type

import os.path
import subprocess
import sys

import jujupy


def main():
    mydir = os.path.dirname(os.path.abspath(sys.argv[0]))
    terminate = os.path.join(mydir, 'ec2-terminate-job-instances')
    for env in sys.argv[1:]:
        environment = jujupy.Environment.from_config(env)
        if environment.config['type'] == 'manual':
            subprocess.check_call(terminate)
        else:
            environment.destroy_environment()



if __name__ == '__main__':
    main()
