#!/usr/bin/python
from __future__ import print_function

__metaclass__ = type

from argparse import ArgumentParser

from deploy_stack import (
    BootstrapManager,
)
from utility import (
    add_basic_testing_arguments
)


TEST_HUMAN_NAME = "<YOUR TEST HUMAN READABLE HERE>"


def parse_args():
    """Parse all arguments."""
    parser = ArgumentParser(TEST_HUMAN_NAME)
    # Add your positional arguments
    add_basic_testing_arguments(parser)
    # Add your optional arguments.
    return parser.parse_args()


def main():
    args = parse_args()
    series = args.series
    if series is None:
        args.series = 'trusty'
    bs_manager = BootstrapManager.from_args(args)
    client = bs_manager.client
    with bs_manager.booted_context(args.upload_tools):
        client.get_status(60)
        # Deploy charms, there are several under ./repository
        client.juju("deploy", ('local:trusty/my-charm',))
        # Wait for the deployment to finish.
        client.wait_for_started()

        # ----------------- CALL YOUR TESTS HERE
        # At this point you have a juju bootstraped with my-charm
        # deployed and active with the agent idle.
        # ----------------- TESTS END HERE


if __name__ == '__main__':
    main()
